
{
    "resources": [
        {
            "type": "containerapp",
            "instances": [
                {
                    "name": "web"
                },
                {
                    "name": "api"
                }
            ]
        },
        {
            "type": "applicationinsights",
            "instances": [
                {
                    "name": "todo_insights"
                }
            ]
        },
        {
            "type": "keyvault",
            "instances": [
                {
                    "name": "todo_kv"
                }
            ]
        },
        {
            "type": "cosmosdb",
            "instances": [
                {
                    "name": "todo_cosmos"
                }
            ]
        }
    ],
    "bindings": [
        {
            "source": "${containerapp.web}",
            "target": "${containerapp.api}",
            "type": "http",
            "key": "API_URL"
        },
        {
            "source": "${containerapp.api}",
            "target": "${applicationinsights.todo_insights}",
            "type": "secret",
            "key": "APPINSIGHTS_INSTRUMENTATIONKEY"
        },
        {
            "source": "${containerapp.api}",
            "target": "${cosmosdb.todo_cosmos}",
            "type": "secret",
            "store": "${keyvault.todo_kv}",
            "key": "COSMOSDB_CONNECTION_STRING"
        }
    ],
    "services": [
        {
            "host": "${containerapp.web}",
            "language": "nodejs",
            "project": "./src/web"
        },
        {
            "host": "${containerapp.api}",
            "language": "python",
            "project": "./src/api"
        }
    ]
}